# Application
spring.application.name=event-hub-backend
server.port=8082

# Supabase PostgreSQL Connection (Transaction Pooler - Port 6543)
# Using Transaction mode instead of Session mode for better connection pooling
# IMPORTANT: Use port 6543 for Transaction mode, NOT 5432 (Session mode)
# Region: Mumbai (ap-south-1) for optimal India latency
spring.datasource.url=jdbc:postgresql://aws-1-ap-south-1.pooler.supabase.com:6543/postgres?prepareThreshold=0
spring.datasource.username=postgres.aoyvpquvjxofdkukmqty
spring.datasource.password=event@9060dbpassword

spring.datasource.driver-class-name=org.postgresql.Driver

# JPA/Hibernate Configuration
spring.jpa.hibernate.ddl-auto=none
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true
spring.jpa.properties.hibernate.generate_statistics=false

# Hibernate Performance Optimizations
spring.jpa.properties.hibernate.default_batch_fetch_size=20
spring.jpa.properties.hibernate.jdbc.fetch_size=50
spring.jpa.open-in-view=false

# Fix for PostgreSQL prepared statement conflicts with connection poolers (Supabase Session Pooler)
# Disable server-side prepared statements to avoid "prepared statement already exists" errors
spring.datasource.hikari.data-source-properties.prepareThreshold=0
spring.jpa.properties.hibernate.jdbc.batch_size=0
spring.jpa.properties.hibernate.order_inserts=false
spring.jpa.properties.hibernate.order_updates=false

# Connection Pool - Settings for Supabase
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=2
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=180000
spring.datasource.hikari.max-lifetime=300000
spring.datasource.hikari.keepalive-time=60000
spring.datasource.hikari.validation-timeout=5000
spring.datasource.hikari.leak-detection-threshold=60000
# Force connection release
spring.datasource.hikari.auto-commit=true

# Logging - reduced for performance
logging.level.org.springframework.web=WARN
logging.level.org.hibernate.SQL=WARN
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=WARN
logging.level.com.zaxxer.hikari=WARN

# JWT Configuration
jwt.secret=your-secret-key-change-this-in-production-min-256-bits-required-for-hmac-sha256-algorithm
jwt.expiration=86400000

# Trigger deployment - Tue Dec  9 19:50:35 IST 2025

# Token Payment Configuration
payment.token.percentage=25

# Payment Gateway Configuration (mock for development)
payment.gateway.url=https://api.razorpay.com
payment.gateway.key=${RAZORPAY_KEY:rzp_test_mock}
payment.gateway.secret=${RAZORPAY_SECRET:mock_secret}

# Refund Policy Configuration
refund.full.days=30
refund.partial.days=15
refund.partial.percentage=50

# Google OAuth Configuration
google.client.id=386113169-ugec31n5ft8uj6gmjtq8o112n7uqe8re.apps.googleusercontent.com

# Email Configuration (Gmail SMTP for Development)
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=cartevent.welcome@gmail.com
spring.mail.password=spvwzabkayjwedne
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.connectiontimeout=5000
spring.mail.properties.mail.smtp.timeout=5000
spring.mail.properties.mail.smtp.writetimeout=5000

# Password Reset Configuration
app.frontend.url=${FRONTEND_URL:http://localhost:8080}
app.email.from=${EMAIL_FROM:cartevent.welcome@gmail.com}
password.reset.token.expiry=3600000

# Cloudflare R2 Storage Configuration
r2.access-key-id=${R2_ACCESS_KEY_ID:10631a60f198d886aa81d1dd276d8f5c}
r2.secret-access-key=${R2_SECRET_ACCESS_KEY:b91e0fe00d087cc37e836d9f5464321eecf324ac9cc61031931e300438c20773}
r2.endpoint=https://95a4d99f54271ae54ee783be0cd09c9f.r2.cloudflarestorage.com
r2.bucket-name=cartevent-images
r2.public-url=https://images.cartevent.com

# Image compression settings
r2.max-width=1920
r2.max-height=1080
r2.compression-quality=0.85

# File upload limits
spring.servlet.multipart.max-file-size=5MB
spring.servlet.multipart.max-request-size=25MB
